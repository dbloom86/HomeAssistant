!function(){"use strict";var t,e=function(){return e=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},e.apply(this,arguments)};function i(t,e,i,o){return new(i||(i=Promise))((function(n,a){function s(t){try{r(o.next(t))}catch(t){a(t)}}function c(t){try{r(o.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,c)}r((o=o.apply(t,e||[])).next())}))}function o(t,e){var i,o,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(r){return function(c){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(s=0)),s;)try{if(i=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,o=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){s.label=c[1];break}if(6===c[0]&&s.label<n[1]){s.label=n[1],n=c;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(c);break}n[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(t,s)}catch(t){c=[6,t],o=0}finally{i=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,r])}}}var n,a,s="kiosk-mode",c="kiosk_mode";!function(t){t.HEADER="kmHeader",t.SIDEBAR="kmSidebar",t.OVERFLOW="kmOverflow",t.MENU_BUTTON="kmMenuButton",t.ACCOUNT="kmAccount",t.SEARCH="kmSearch",t.ASSISTANT="kmAssistant",t.REFRESH="kmRefresh",t.UNUSED_ENTITIES="kmUnusedEntities",t.RELOAD_RESOURCES="kmReloadResources",t.EDIT_DASHBOARD="kmEditDashboard",t.MOUSE="kmMouse"}(n||(n={})),function(t){t.KIOSK="kiosk",t.CACHE="cache",t.CLEAR_CACHE="clear_km_cache",t.DISABLE_KIOSK_MODE="disable_km",t.HIDE_SIDEBAR="hide_sidebar",t.HIDE_HEADER="hide_header",t.HIDE_OVERFLOW="hide_overflow",t.HIDE_MENU_BUTTON="hide_menubutton",t.HIDE_ACCOUNT="hide_account",t.HIDE_SEARCH="hide_search",t.HIDE_ASSISTANT="hide_assistant",t.HIDE_REFRESH="hide_refresh",t.HIDE_UNUSED_ENTITIES="hide_unused_entities",t.HIDE_RELOAD_RESOURCES="hide_reload_resources",t.HIDE_EDIT_DASHBOARD="hide_edit_dashboard",t.BLOCK_MOUSE="block_mouse"}(a||(a={}));var r,E,h="".concat("ui",".common"),d="".concat("ui",".panel"),u="".concat(d,".lovelace"),S="".concat(u,".menu");!function(t){t.SEARCH="SEARCH",t.ASSIST="ASSIST",t.REFRESH="REFRESH",t.UNUSED_ENTITIES="UNUSED_ENTITIES",t.RELOAD_RESOURCES="RELOAD_RESOURCES",t.EDIT_DASHBOARD="EDIT_DASHBOARD"}(r||(r={})),function(t){t.STORAGE="storage",t.YAML="yaml"}(E||(E={}));var l,_=Object.freeze(((t={})[r.SEARCH]="".concat(S,".search"),t[r.ASSIST]="".concat(S,".assist"),t[r.REFRESH]="".concat(h,".refresh"),t[r.UNUSED_ENTITIES]="".concat(u,".unused_entities.title"),t[r.RELOAD_RESOURCES]="".concat(S,".reload_resources"),t[r.EDIT_DASHBOARD]="".concat(S,".configure_ui"),t));!function(t){t.HOME_ASSISTANT="home-assistant",t.HOME_ASSISTANT_MAIN="home-assistant-main",t.HA_PANEL_LOVELACE="ha-panel-lovelace",t.PARTIAL_PANEL_RESOLVER="partial-panel-resolver",t.HUI_ROOT="hui-root",t.HUI_VIEW="hui-view",t.MENU_ITEM="ha-icon-button",t.MENU_ITEM_ICON="mwc-icon-button",t.OVERLAY_MENU="ha-button-menu",t.OVERLAY_MENU_ITEM="mwc-list-item",t.APP_DRAWER_LAYOUT="app-drawer-layout",t.APP_TOOLBAR="app-toolbar",t.APP_DRAWER="app-drawer",t.HA_SIDEBAR="ha-sidebar",t.HA_DRAWER="ha-drawer",t.TOOLBAR=".toolbar",t.ACTION_ITEMS=".action-items"}(l||(l={}));var R="true",A="boolean",O="state_changed",D=500,T=function(t){return Array.isArray(t)?t:[t]},I=function(t){return t instanceof ShadowRoot?t.host.localName:t.localName},U=function(t){var e=I(t);return t.querySelector("#".concat(c,"_").concat(e))},f=function(t,e){var i=I(e),o=U(e);o||((o=document.createElement("style")).setAttribute("id","".concat(c,"_").concat(i)),e.appendChild(o)),o.innerHTML=t},p=function(t){T(t).forEach((function(t){var e=I(t);U(t)&&t.querySelector("#".concat(c,"_").concat(e)).remove()}))},H=function(t){return T(t).some((function(t){return window.location.search.includes(t)}))},N=function(t,e){T(t).forEach((function(t){return window.localStorage.setItem(t,e)}))},M=function(t){return T(t).some((function(t){return window.localStorage.getItem(t)===R}))},b=function(t){return Object.entries(t).map((function(t){var e=t[0],i=t[1];return"".concat(e,":").concat(i)})).join(";")+";"},m=function(t){return Object.entries(t).map((function(t){var e=t[0],i=t[1];return"".concat(e,"{").concat(b(i),"}")})).join("")},v=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.map((function(t){return"".concat(t,"{display: none !important;}")})).join("")},w=function(t){var e=0,i=Object.values(_);return new Promise((function(o,n){var a=function(){var s,c=null===(s=null==t?void 0:t.hass)||void 0===s?void 0:s.resources,r=!1;if(c){var E=t.hass.language;i.find((function(t){return!c[E][t]}))||(r=!0)}r?o(c):++e<D?setTimeout(a,50):n()};a()}))},L=function(t){return new Promise((function(e,i){var o=0,n=function(){var a=t();a&&a.length?e(a):++o<D?setTimeout(n,50):i()};n()}))},C="app-toolbar",y=".toolbar",k=".action-items",B="ha-button-menu",g="mwc-list-item",F={HEADER:m({"#view":{"min-height":"100vh !important","--header-height":"0px"}}),ACCOUNT:v(".profile"),MENU_BUTTON:v(".menu ha-icon-button"),MENU_BUTTON_BURGER:v("ha-menu-button"),MOUSE:m({"body::after":{bottom:"0",content:'""',cursor:"none",display:"block",left:"0",position:"fixed",right:"0",top:"0","z-index":"999999"}})},K={HEADER:m({"app-header":{display:"none"}}),SIDEBAR:m({":host":{"--app-drawer-width":"0 !important"},"#drawer":{display:"none"}}),OVERFLOW_MENU:v("".concat(C," > ").concat(B)),OVERFLOW_MENU_EMPTY_DESKTOP:v("".concat(C," > ").concat(B,"[data-lovelace-mode=").concat(E.STORAGE,'][data-children="1"]'),"".concat(C," > ").concat(B,"[data-lovelace-mode=").concat(E.YAML,'][data-children="4"]')),OVERFLOW_MENU_EMPTY_MOBILE:v("".concat(C," > ").concat(B,"[data-lovelace-mode=").concat(E.STORAGE,'][data-children="3"]'),"".concat(C," > ").concat(B,"[data-lovelace-mode=").concat(E.YAML,'][data-children="6"]')),SEARCH:v("".concat(C,' > ha-icon-button[data-selector="').concat(r.SEARCH,'"]'),"".concat(C," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.SEARCH,'"]')),ASSISTANT:v("".concat(C,' > ha-icon-button[data-selector="').concat(r.ASSIST,'"]'),"".concat(C," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.ASSIST,'"]')),REFRESH:v("".concat(C," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.REFRESH,'"]')),UNUSED_ENTITIES:v("".concat(C," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.UNUSED_ENTITIES,'"]')),RELOAD_RESOURCES:v("".concat(C," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.RELOAD_RESOURCES,'"]')),EDIT_DASHBOARD:v("".concat(C," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.EDIT_DASHBOARD,'"]'))},W={HEADER:m({".header":{display:"none"}}),SIDEBAR:m({":host":{"--mdc-drawer-width":"0 !important"},"partial-panel-resolver":{"--mdc-top-app-bar-width":"100% !important"},"ha-drawer > ha-sidebar":{display:"none"},".header":{width:"100% !important"}}),ASIDE:v(".mdc-drawer"),OVERFLOW_MENU:v("".concat(y," > ").concat(k," > ").concat(B)),OVERFLOW_MENU_EMPTY_DESKTOP:v("".concat(y," > ").concat(k," > ").concat(B,"[data-lovelace-mode=").concat(E.STORAGE,'][data-children="1"]'),"".concat(y," > ").concat(k," > ").concat(B,"[data-lovelace-mode=").concat(E.YAML,'][data-children="4"]')),OVERFLOW_MENU_EMPTY_MOBILE:v("".concat(y," > ").concat(k," > ").concat(B,"[data-lovelace-mode=").concat(E.STORAGE,'][data-children="3"]'),"".concat(y," > ").concat(k," > ").concat(B,"[data-lovelace-mode=").concat(E.YAML,'][data-children="6"]')),SEARCH:v("".concat(y," > ").concat(k,' > ha-icon-button[data-selector="').concat(r.SEARCH,'"]'),"".concat(y," > ").concat(k," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.SEARCH,'"]')),ASSISTANT:v("".concat(y," > ").concat(k,' > ha-icon-button[data-selector="').concat(r.ASSIST,'"]'),"".concat(y," > ").concat(k," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.ASSIST,'"]')),REFRESH:v("".concat(y," > ").concat(k," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.REFRESH,'"]')),UNUSED_ENTITIES:v("".concat(y," > ").concat(k," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.UNUSED_ENTITIES,'"]')),RELOAD_RESOURCES:v("".concat(y," > ").concat(k," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.RELOAD_RESOURCES,'"]')),EDIT_DASHBOARD:v("".concat(y," > ").concat(k," > ").concat(B," > ").concat(g,'[data-selector="').concat(r.EDIT_DASHBOARD,'"]'))},P=function(t){return t?{HEADER:"".concat(F.HEADER).concat(K.HEADER),SIDEBAR:K.SIDEBAR,ASIDE:"",ACCOUNT:F.ACCOUNT,MENU_BUTTON:F.MENU_BUTTON,MENU_BUTTON_BURGER:F.MENU_BUTTON_BURGER,OVERFLOW_MENU:K.OVERFLOW_MENU,OVERFLOW_MENU_EMPTY_DESKTOP:K.OVERFLOW_MENU_EMPTY_DESKTOP,OVERFLOW_MENU_EMPTY_MOBILE:K.OVERFLOW_MENU_EMPTY_MOBILE,SEARCH:K.SEARCH,ASSISTANT:K.ASSISTANT,REFRESH:K.REFRESH,UNUSED_ENTITIES:K.UNUSED_ENTITIES,RELOAD_RESOURCES:K.RELOAD_RESOURCES,EDIT_DASHBOARD:K.EDIT_DASHBOARD,MOUSE:F.MOUSE}:{HEADER:"".concat(F.HEADER).concat(W.HEADER),SIDEBAR:W.SIDEBAR,ASIDE:W.ASIDE,ACCOUNT:F.ACCOUNT,MENU_BUTTON:F.MENU_BUTTON,MENU_BUTTON_BURGER:F.MENU_BUTTON_BURGER,OVERFLOW_MENU:W.OVERFLOW_MENU,OVERFLOW_MENU_EMPTY_DESKTOP:W.OVERFLOW_MENU_EMPTY_DESKTOP,OVERFLOW_MENU_EMPTY_MOBILE:W.OVERFLOW_MENU_EMPTY_MOBILE,SEARCH:W.SEARCH,ASSISTANT:W.ASSISTANT,REFRESH:W.REFRESH,UNUSED_ENTITIES:W.UNUSED_ENTITIES,RELOAD_RESOURCES:W.RELOAD_RESOURCES,EDIT_DASHBOARD:W.EDIT_DASHBOARD,MOUSE:F.MOUSE}},V=function(){function t(){this.lines=[{content:"%c≡ kiosk-mode",color:"white",background:"#03a9f4"},{content:"%cversion ".concat("1.9.2")}]}return t.prototype.log=function(){var t=[],i=[],o=this.lines.length-1,n={display:"inline-block","font-size":"12px","border-style":"solid","border-color":"#424242"};this.lines.forEach((function(a,s){t.push(a.content.padEnd(27)),t.push("%c⋮"),s!==o&&t.push("%c\n");var c="0 0 0 1px",r="0 1px 0 1px";0===o?(c="1px 0 1px 1px",r="1px 1px 1px 0"):0===s?(c="1px 0 0 1px",r="1px 1px 0 0"):s===o&&(c="0 0 1px 1px",r="0 1px 1px 0"),i.push(b(e(e({},n),{background:a.background||"white",color:a.color||"#424242",padding:0===s?"5px 0 5px 5px":"7px 0 7px 10px","border-width":c}))),i.push(b(e(e({},n),{background:a.background||"white",color:a.color||"white",padding:0===s?"5px":"7px 5px 7px 0px","border-width":r}))),s!==o&&i.push("")})),console.info.apply(console,function(t,e,i){if(i||2===arguments.length)for(var o,n=0,a=e.length;n<a;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))}([t.join("")],i,!1))},t}(),x=function(){function t(){var t,e,c,r=this;window.kioskModeEntities={},H(a.CLEAR_CACHE)&&N([n.HEADER,n.SIDEBAR,n.OVERFLOW,n.MENU_BUTTON,n.ACCOUNT,n.SEARCH,n.ASSISTANT,n.REFRESH,n.UNUSED_ENTITIES,n.RELOAD_RESOURCES,n.EDIT_DASHBOARD,n.MOUSE],"false"),this.ha=document.querySelector(l.HOME_ASSISTANT),this.main=this.ha.shadowRoot.querySelector(l.HOME_ASSISTANT_MAIN).shadowRoot,this.user=this.ha.hass.user,this.isLegacy=function(t){var e=function(t){var e=t?t.match(/^(\d+)\.(\d+)\.(\w+)(?:\.(\w+))?$/):null;return e?[+e[1],+e[2],e[3]]:null}(t);return!!e&&e[0]<=2023&&e[1]<=3}(null===(e=null===(t=this.ha.hass)||void 0===t?void 0:t.config)||void 0===e?void 0:e.version),this.resizeWindowBinded=this.resizeWindow.bind(this),this.run(),this.entityWatch(),(c=this.ha,i(void 0,void 0,void 0,(function(){var t,e,i,n,a;return o(this,(function(o){switch(o.label){case 0:return[4,w(c)];case 1:return t=o.sent(),e=c.hass.language,i=t[e],n=Object.entries(_),a=n.map((function(t){var e=t[0],o=t[1];return[i[o],e]})),[2,Object.fromEntries(a)]}}))}))).then((function(t){r.menuTranslations=t,r.updateMenuItemsLabels()})).catch((function(){console.info("".concat(s," Cannot get resources translations"))})),new MutationObserver(this.watchDashboards).observe(this.main.querySelector(l.PARTIAL_PANEL_RESOLVER),{childList:!0})}return t.prototype.run=function(t){void 0===t&&(t=this.main.querySelector(l.HA_PANEL_LOVELACE)),t&&(this.lovelace=t,this.getConfig())},t.prototype.getConfig=function(){var t,e=this;(t=this.lovelace,new Promise((function(e,i){var o=0,n=function(){var a,s=null===(a=null==t?void 0:t.lovelace)||void 0===a?void 0:a.config;s?e(s):++o<D?setTimeout(n,50):i()};n()}))).then((function(t){e.processConfig(t.kiosk_mode||{})})).catch((function(){throw new Error("Lovelace config not found. Giving up after ".concat(D," attempts."))}))},t.prototype.processConfig=function(t){var e,i,o=this,s=this.ha.hass.panelUrl;if(window.kioskModeEntities[s]||(window.kioskModeEntities[s]=[]),this.hideHeader=!1,this.hideSidebar=!1,this.hideOverflow=!1,this.hideMenuButton=!1,this.hideAccount=!1,this.hideSearch=!1,this.hideAssistant=!1,this.hideRefresh=!1,this.hideUnusedEntities=!1,this.hideReloadResources=!1,this.hideEditDashboard=!1,this.blockMouse=!1,this.ignoreEntity=!1,this.ignoreMobile=!1,this.ignoreDisableKm=!1,this.mode=(null===(i=null===(e=this.lovelace)||void 0===e?void 0:e.lovelace)||void 0===i?void 0:i.mode)||E.STORAGE,this.huiRoot=this.lovelace.shadowRoot.querySelector(l.HUI_ROOT).shadowRoot,this.isLegacy){this.drawerLayout=this.main.querySelector(l.APP_DRAWER_LAYOUT),this.appToolbar=this.huiRoot.querySelector(l.APP_TOOLBAR);var c=this.drawerLayout.querySelector(l.APP_DRAWER);this.sideBarRoot=c.querySelector(l.HA_SIDEBAR).shadowRoot,this.overlayMenu=this.appToolbar.querySelector(":scope > ".concat(l.OVERLAY_MENU))}else this.drawerLayout=this.main.querySelector(l.HA_DRAWER),this.appToolbar=this.huiRoot.querySelector(l.TOOLBAR),this.sideBarRoot=this.drawerLayout.querySelector(l.HA_SIDEBAR).shadowRoot,this.overlayMenu=this.appToolbar.querySelector(":scope > ".concat(l.ACTION_ITEMS," > ").concat(l.OVERLAY_MENU));var r=M([n.HEADER,n.SIDEBAR,n.OVERFLOW,n.MENU_BUTTON,n.ACCOUNT,n.SEARCH,n.ASSISTANT,n.REFRESH,n.UNUSED_ENTITIES,n.RELOAD_RESOURCES,n.EDIT_DASHBOARD,n.MOUSE])||H([a.KIOSK,a.HIDE_HEADER,a.HIDE_SIDEBAR,a.HIDE_OVERFLOW,a.HIDE_MENU_BUTTON,a.HIDE_ACCOUNT,a.HIDE_SEARCH,a.HIDE_ASSISTANT,a.HIDE_REFRESH,a.HIDE_RELOAD_RESOURCES,a.HIDE_UNUSED_ENTITIES,a.HIDE_EDIT_DASHBOARD,a.BLOCK_MOUSE]);r&&(this.hideHeader=M(n.HEADER)||H([a.KIOSK,a.HIDE_HEADER]),this.hideSidebar=M(n.SIDEBAR)||H([a.KIOSK,a.HIDE_SIDEBAR]),this.hideOverflow=M(n.OVERFLOW)||H([a.KIOSK,a.HIDE_OVERFLOW]),this.hideMenuButton=M(n.MENU_BUTTON)||H([a.KIOSK,a.HIDE_MENU_BUTTON]),this.hideAccount=M(n.ACCOUNT)||H([a.KIOSK,a.HIDE_ACCOUNT]),this.hideSearch=M(n.SEARCH)||H([a.KIOSK,a.HIDE_SEARCH]),this.hideAssistant=M(n.ASSISTANT)||H([a.KIOSK,a.HIDE_ASSISTANT]),this.hideRefresh=M(n.REFRESH)||H([a.KIOSK,a.HIDE_REFRESH]),this.hideUnusedEntities=M(n.UNUSED_ENTITIES)||H([a.KIOSK,a.HIDE_UNUSED_ENTITIES]),this.hideReloadResources=M(n.RELOAD_RESOURCES)||H([a.KIOSK,a.HIDE_RELOAD_RESOURCES]),this.hideEditDashboard=M(n.EDIT_DASHBOARD)||H([a.KIOSK,a.HIDE_EDIT_DASHBOARD]),this.blockMouse=M(n.MOUSE)||H([a.BLOCK_MOUSE])),this.hideHeader=r?this.hideHeader:t.kiosk||t.hide_header,this.hideSidebar=r?this.hideSidebar:t.kiosk||t.hide_sidebar,this.hideOverflow=r?this.hideOverflow:t.kiosk||t.hide_overflow,this.hideMenuButton=r?this.hideMenuButton:t.kiosk||t.hide_menubutton,this.hideAccount=r?this.hideAccount:t.kiosk||t.hide_account,this.hideSearch=r?this.hideSearch:t.kiosk||t.hide_search,this.hideAssistant=r?this.hideAssistant:t.kiosk||t.hide_assistant,this.hideRefresh=r?this.hideRefresh:t.kiosk||t.hide_refresh,this.hideUnusedEntities=r?this.hideUnusedEntities:t.kiosk||t.hide_unused_entities,this.hideReloadResources=r?this.hideReloadResources:t.kiosk||t.hide_reload_resources,this.hideEditDashboard=r?this.hideEditDashboard:t.kiosk||t.hide_edit_dashboard,this.blockMouse=r?this.blockMouse:t.block_mouse;var h=this.user.is_admin?t.admin_settings:t.non_admin_settings;h&&this.setOptions(h),t.user_settings&&T(t.user_settings).forEach((function(t){T(t.users).some((function(t){return t.toLowerCase()===o.user.name.toLowerCase()}))&&o.setOptions(t)}));var d=this.ignoreMobile?null:t.mobile_settings;if(d){var u=d.custom_width?d.custom_width:812;window.innerWidth<=u&&this.setOptions(d)}var S=this.ignoreEntity?null:t.entity_settings;if(S)for(var _=0,R=S;_<R.length;_++){var A=R[_],O=Object.keys(A.entity)[0];window.kioskModeEntities[s].includes(O)||window.kioskModeEntities[s].push(O),this.ha.hass.states[O].state==A.entity[O]&&(a.HIDE_HEADER in A&&(this.hideHeader=A[a.HIDE_HEADER]),a.HIDE_SIDEBAR in A&&(this.hideSidebar=A[a.HIDE_SIDEBAR]),a.HIDE_OVERFLOW in A&&(this.hideOverflow=A[a.HIDE_OVERFLOW]),a.HIDE_MENU_BUTTON in A&&(this.hideMenuButton=A[a.HIDE_MENU_BUTTON]),a.HIDE_ACCOUNT in A&&(this.hideAccount=A[a.HIDE_ACCOUNT]),a.HIDE_SEARCH in A&&(this.hideSearch=A[a.HIDE_SEARCH]),a.HIDE_ASSISTANT in A&&(this.hideAssistant=A[a.HIDE_ASSISTANT]),a.HIDE_REFRESH in A&&(this.hideRefresh=A[a.HIDE_REFRESH]),a.HIDE_UNUSED_ENTITIES in A&&(this.hideUnusedEntities=A[a.HIDE_UNUSED_ENTITIES]),a.HIDE_RELOAD_RESOURCES in A&&(this.hideReloadResources=A[a.HIDE_RELOAD_RESOURCES]),a.HIDE_EDIT_DASHBOARD in A&&(this.hideEditDashboard=A[a.HIDE_EDIT_DASHBOARD]),a.BLOCK_MOUSE in A&&(this.blockMouse=A[a.BLOCK_MOUSE]),a.KIOSK in A&&(this.hideHeader=this.hideSidebar=A[a.KIOSK]))}H(a.DISABLE_KIOSK_MODE)&&!this.ignoreDisableKm||this.insertStyles()},t.prototype.insertStyles=function(){var t=P(this.isLegacy);if(this.hideHeader?(f(t.HEADER,this.huiRoot),H(a.CACHE)&&N(n.HEADER,R)):p(this.huiRoot),this.hideSidebar?(f(t.SIDEBAR,this.drawerLayout),this.isLegacy||f(t.ASIDE,this.drawerLayout.shadowRoot),H(a.CACHE)&&N(n.SIDEBAR,R)):(p(this.drawerLayout),this.isLegacy||p(this.drawerLayout.shadowRoot)),this.hideAccount||this.hideMenuButton){var e=[this.hideAccount?t.ACCOUNT:"",this.hideMenuButton?t.MENU_BUTTON:""];f(e.join(""),this.sideBarRoot),this.hideAccount&&H(a.CACHE)&&N(n.ACCOUNT,R)}else p(this.sideBarRoot);if(this.hideSearch||this.hideAssistant||this.hideRefresh||this.hideUnusedEntities||this.hideReloadResources||this.hideEditDashboard||this.hideMenuButton||this.hideOverflow||this.hideSidebar){e=[this.hideSearch?t.SEARCH:"",this.hideAssistant?t.ASSISTANT:"",this.hideRefresh?t.REFRESH:"",this.hideUnusedEntities?t.UNUSED_ENTITIES:"",this.hideReloadResources?t.RELOAD_RESOURCES:"",this.hideEditDashboard?t.EDIT_DASHBOARD:"",this.hideOverflow?t.OVERFLOW_MENU:"",this.hideEditDashboard&&(this.mode===E.STORAGE||this.mode===E.YAML&&this.hideRefresh&&this.hideUnusedEntities&&this.hideReloadResources)?t.OVERFLOW_MENU_EMPTY_DESKTOP:"",this.hideSearch&&this.hideAssistant&&this.hideEditDashboard&&(this.mode===E.STORAGE||this.mode===E.YAML&&this.hideRefresh&&this.hideUnusedEntities&&this.hideReloadResources)?t.OVERFLOW_MENU_EMPTY_MOBILE:"",this.hideMenuButton||this.hideSidebar?t.MENU_BUTTON_BURGER:""];f(e.join(""),this.appToolbar),H(a.CACHE)&&(this.hideSearch&&N(n.SEARCH,R),this.hideAssistant&&N(n.ASSISTANT,R),this.hideRefresh&&N(n.REFRESH,R),this.hideUnusedEntities&&N(n.UNUSED_ENTITIES,R),this.hideReloadResources&&N(n.RELOAD_RESOURCES,R),this.hideEditDashboard&&N(n.EDIT_DASHBOARD,R),this.hideOverflow&&N(n.OVERFLOW,R),this.hideMenuButton&&N(n.MENU_BUTTON,R))}else p(this.appToolbar);this.blockMouse?(f(t.MOUSE,document.body),H(a.CACHE)&&N(n.MOUSE,R)):p(document.body),window.removeEventListener("resize",this.resizeWindowBinded),window.addEventListener("resize",this.resizeWindowBinded),window.dispatchEvent(new Event("resize"))},t.prototype.resizeWindow=function(){var t=this;window.clearTimeout(this.resizeDelay),this.resizeDelay=window.setTimeout((function(){t.updateMenuItemsLabels()}),250)},t.prototype.watchDashboards=function(t){t.forEach((function(t){t.addedNodes.forEach((function(t){t.localName===l.HA_PANEL_LOVELACE&&window.KioskMode.run(t)}))}))},t.prototype.updateMenuItemsLabels=function(){var t=this;if(this.menuTranslations){L((function(){return t.isLegacy?t.appToolbar.querySelectorAll(":scope > ".concat(l.MENU_ITEM)):t.appToolbar.querySelectorAll(":scope > ".concat(l.ACTION_ITEMS," > ").concat(l.MENU_ITEM))})).then((function(e){e.forEach((function(e){if(e&&e.dataset&&!e.dataset.selector){var i=e.shadowRoot.querySelector(l.MENU_ITEM_ICON);e.dataset.selector=t.menuTranslations[i.title]}}))})).catch((function(){console.info("".concat(s," Cannot select app toolbar menu items"))})),this.user.is_admin&&L((function(){return t.appToolbar.querySelectorAll(l.OVERLAY_MENU_ITEM)})).then((function(e){e.forEach((function(e){if(e&&e.dataset&&!e.dataset.selector){var i=e.textContent.trim();e.dataset.selector=t.menuTranslations[i]}})),t.overlayMenu&&t.overlayMenu.dataset&&(t.overlayMenu.dataset.children="".concat(e.length),t.overlayMenu.dataset.lovelaceMode||(t.overlayMenu.dataset.lovelaceMode=t.mode))})).catch((function(){console.info("".concat(s," Cannot select overflow menu items"))}))}},t.prototype.entityWatch=function(){return i(this,void 0,void 0,(function(){var t=this;return o(this,(function(e){switch(e.label){case 0:return[4,window.hassConnection];case 1:return e.sent().conn.subscribeMessage((function(e){return t.entityWatchCallback(e)}),{type:"subscribe_events",event_type:O}),[2]}}))}))},t.prototype.entityWatchCallback=function(t){var e=window.kioskModeEntities[this.ha.hass.panelUrl]||[];!e.length||t.event_type!==O||!e.includes(t.data.entity_id)||t.data.old_state&&t.data.new_state.state===t.data.old_state.state||this.run()},t.prototype.setOptions=function(t){this.hideHeader=t.kiosk||t.hide_header,this.hideSidebar=t.kiosk||t.hide_sidebar,this.hideOverflow=t.kiosk||t.hide_overflow,this.hideMenuButton=t.kiosk||t.hide_menubutton,this.hideAccount=t.kiosk||t.hide_account,this.hideSearch=t.kiosk||t.hide_search,this.hideAssistant=t.kiosk||t.hide_assistant,this.hideRefresh=t.kiosk||t.hide_refresh,this.hideUnusedEntities=t.kiosk||t.hide_unused_entities,this.hideReloadResources=t.kiosk||t.hide_reload_resources,this.hideEditDashboard=t.kiosk||t.hide_edit_dashboard,this.blockMouse=t.block_mouse,this.ignoreEntity=typeof t.ignore_entity_settings===A?t.ignore_entity_settings:this.ignoreEntity,this.ignoreMobile=typeof t.ignore_mobile_settings===A?t.ignore_mobile_settings:this.ignoreMobile,this.ignoreDisableKm=typeof t.ignore_disable_km===A?t.ignore_disable_km:this.ignoreDisableKm},t}();(new V).log(),Promise.resolve(customElements.whenDefined(l.HUI_VIEW)).then((function(){window.KioskMode=new x}))}();
